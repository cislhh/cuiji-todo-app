{"version":3,"file":"cloud-diagnosis.js","sources":["pages/cloud-diagnosis/cloud-diagnosis.vue","../../../software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2xvdWQtZGlhZ25vc2lzL2Nsb3VkLWRpYWdub3Npcy52dWU"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"header\">\n      <text class=\"title\">云开发诊断</text>\n    </view>\n\n    <view class=\"diagnosis-section\">\n      <view class=\"diagnosis-item\">\n        <text class=\"diagnosis-label\">1. 检查云开发环境</text>\n        <view class=\"btn\" @click=\"checkCloudEnv\">\n          <text>检查</text>\n        </view>\n      </view>\n\n      <view class=\"diagnosis-item\">\n        <text class=\"diagnosis-label\">2. 检查云函数列表</text>\n        <view class=\"btn\" @click=\"checkCloudFunctions\">\n          <text>检查</text>\n        </view>\n      </view>\n\n      <view class=\"diagnosis-item\">\n        <text class=\"diagnosis-label\">3. 测试云函数调用</text>\n        <view class=\"btn\" @click=\"testCloudCall\">\n          <text>测试</text>\n        </view>\n      </view>\n    </view>\n\n    <view class=\"result-section\">\n      <text class=\"result-title\">诊断结果：</text>\n      <text class=\"result-text\">{{ diagnosisResult }}</text>\n    </view>\n\n    <view class=\"help-section\">\n      <text class=\"help-title\">解决步骤：</text>\n      <text class=\"help-text\">1. 在微信开发者工具中开通云开发服务</text>\n      <text class=\"help-text\">2. 在HBuilderX中关联云服务空间</text>\n      <text class=\"help-text\">3. 上传云函数到云端</text>\n      <text class=\"help-text\">4. 初始化数据库集合</text>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref } from \"vue\";\n\nconst diagnosisResult = ref(\"等待诊断...\");\n\n// 检查云开发环境\nconst checkCloudEnv = async () => {\n  diagnosisResult.value = \"正在检查云开发环境...\";\n\n  try {\n    // 检查uniCloud是否可用\n    if (typeof uniCloud === \"undefined\") {\n      diagnosisResult.value = \"❌ uniCloud未初始化，请检查manifest.json配置\";\n      return;\n    }\n\n    // 尝试获取云开发信息\n    const info = uniCloud.getCloudInfo();\n    diagnosisResult.value = `✅ 云开发环境正常\\n环境ID: ${\n      info.envId || \"未设置\"\n    }`;\n  } catch (error) {\n    diagnosisResult.value = `❌ 云开发环境检查失败: ${error.message}`;\n  }\n};\n\n// 检查云函数列表\nconst checkCloudFunctions = async () => {\n  diagnosisResult.value = \"正在检查云函数列表...\";\n\n  try {\n    // 尝试调用一个简单的云函数\n    const result = await uniCloud.callFunction({\n      name: \"init-database\",\n    });\n\n    diagnosisResult.value = `✅ 云函数调用成功\\n返回: ${JSON.stringify(\n      result.result\n    )}`;\n  } catch (error) {\n    if (\n      error.message.includes(\"not found\") ||\n      error.message.includes(\"未匹配\")\n    ) {\n      diagnosisResult.value = `❌ 云函数未找到\\n错误: ${error.message}\\n\\n解决方案:\\n1. 确保已上传云函数到云端\\n2. 检查云函数名称是否正确\\n3. 确认云服务空间已关联`;\n    } else {\n      diagnosisResult.value = `❌ 云函数调用失败: ${error.message}`;\n    }\n  }\n};\n\n// 测试云函数调用\nconst testCloudCall = async () => {\n  diagnosisResult.value = \"正在测试云函数调用...\";\n\n  try {\n    // 测试多个云函数\n    const functions = [\"init-database\", \"task-list\", \"task-create\"];\n    const results = [];\n\n    for (const funcName of functions) {\n      try {\n        const result = await uniCloud.callFunction({\n          name: funcName,\n          data: funcName === \"task-list\" ? { page: 1, pageSize: 1 } : {},\n        });\n        results.push(`✅ ${funcName}: 成功`);\n      } catch (error) {\n        results.push(`❌ ${funcName}: ${error.message}`);\n      }\n    }\n\n    diagnosisResult.value = `云函数测试结果:\\n${results.join(\"\\n\")}`;\n  } catch (error) {\n    diagnosisResult.value = `❌ 云函数测试失败: ${error.message}`;\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  padding: 40rpx;\n  min-height: 100vh;\n  background: #f5f5f5;\n}\n\n.header {\n  text-align: center;\n  margin-bottom: 60rpx;\n\n  .title {\n    font-size: 36rpx;\n    font-weight: bold;\n    color: #333;\n  }\n}\n\n.diagnosis-section {\n  background: white;\n  border-radius: 20rpx;\n  padding: 40rpx;\n  margin-bottom: 40rpx;\n\n  .diagnosis-item {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 30rpx 0;\n    border-bottom: 1rpx solid #eee;\n\n    &:last-child {\n      border-bottom: none;\n    }\n\n    .diagnosis-label {\n      font-size: 28rpx;\n      color: #333;\n      flex: 1;\n    }\n\n    .btn {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: white;\n      padding: 20rpx 40rpx;\n      border-radius: 20rpx;\n      font-size: 24rpx;\n\n      &:active {\n        opacity: 0.8;\n      }\n    }\n  }\n}\n\n.result-section {\n  background: white;\n  border-radius: 20rpx;\n  padding: 40rpx;\n  margin-bottom: 40rpx;\n\n  .result-title {\n    font-size: 28rpx;\n    font-weight: bold;\n    color: #333;\n    display: block;\n    margin-bottom: 20rpx;\n  }\n\n  .result-text {\n    font-size: 24rpx;\n    color: #666;\n    line-height: 1.5;\n    white-space: pre-line;\n  }\n}\n\n.help-section {\n  background: #fff7e6;\n  border-radius: 20rpx;\n  padding: 40rpx;\n\n  .help-title {\n    font-size: 28rpx;\n    font-weight: bold;\n    color: #fa8c16;\n    display: block;\n    margin-bottom: 20rpx;\n  }\n\n  .help-text {\n    font-size: 24rpx;\n    color: #fa8c16;\n    line-height: 1.8;\n    display: block;\n    margin-bottom: 10rpx;\n  }\n}\n</style>\n","import MiniProgramPage from 'D:/programming/cuiji-todo-app/cuiji-todo-app/pages/cloud-diagnosis/cloud-diagnosis.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uniCloud"],"mappings":";;;;;AA+CA,UAAM,kBAAkBA,cAAAA,IAAI,SAAS;AAGrC,UAAM,gBAAgB,YAAY;AAChC,sBAAgB,QAAQ;AAExB,UAAI;AAEF,YAAI,OAAOC,cAAQ,OAAK,aAAa;AACnC,0BAAgB,QAAQ;AACxB;AAAA,QACD;AAGD,cAAM,OAAOA,iBAAS;AACtB,wBAAgB,QAAQ;AAAA,QACtB,KAAK,SAAS,KACpB;AAAA,MACG,SAAQ,OAAO;AACd,wBAAgB,QAAQ,gBAAgB,MAAM,OAAO;AAAA,MACtD;AAAA,IACH;AAGA,UAAM,sBAAsB,YAAY;AACtC,sBAAgB,QAAQ;AAExB,UAAI;AAEF,cAAM,SAAS,MAAMA,cAAQ,GAAC,aAAa;AAAA,UACzC,MAAM;AAAA,QACZ,CAAK;AAED,wBAAgB,QAAQ;AAAA,MAAkB,KAAK;AAAA,UAC7C,OAAO;AAAA,QACR,CAAA;AAAA,MACF,SAAQ,OAAO;AACd,YACE,MAAM,QAAQ,SAAS,WAAW,KAClC,MAAM,QAAQ,SAAS,KAAK,GAC5B;AACA,0BAAgB,QAAQ;AAAA,MAAiB,MAAM,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAC5D,OAAW;AACL,0BAAgB,QAAQ,cAAc,MAAM,OAAO;AAAA,QACpD;AAAA,MACF;AAAA,IACH;AAGA,UAAM,gBAAgB,YAAY;AAChC,sBAAgB,QAAQ;AAExB,UAAI;AAEF,cAAM,YAAY,CAAC,iBAAiB,aAAa,aAAa;AAC9D,cAAM,UAAU,CAAA;AAEhB,mBAAW,YAAY,WAAW;AAChC,cAAI;AACF,kBAAM,SAAS,MAAMA,cAAQ,GAAC,aAAa;AAAA,cACzC,MAAM;AAAA,cACN,MAAM,aAAa,cAAc,EAAE,MAAM,GAAG,UAAU,EAAC,IAAK,CAAE;AAAA,YACxE,CAAS;AACD,oBAAQ,KAAK,KAAK,QAAQ,MAAM;AAAA,UACjC,SAAQ,OAAO;AACd,oBAAQ,KAAK,KAAK,QAAQ,KAAK,MAAM,OAAO,EAAE;AAAA,UAC/C;AAAA,QACF;AAED,wBAAgB,QAAQ;AAAA,EAAa,QAAQ,KAAK,IAAI,CAAC;AAAA,MACxD,SAAQ,OAAO;AACd,wBAAgB,QAAQ,cAAc,MAAM,OAAO;AAAA,MACpD;AAAA,IACH;;;;;;;;;;;;ACvHA,GAAG,WAAW,eAAe;"}