{"version":3,"file":"tasks.js","sources":["pages/tasks/tasks.vue","../../../software/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdGFza3MvdGFza3MudnVl"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <!-- È°µÈù¢Ê†áÈ¢ò -->\n    <view class=\"header\">\n      <text class=\"title\">‰ªªÂä°ÁÆ°ÁêÜ</text>\n      <view class=\"add-btn\" @click=\"goToAddPage\">\n        <text class=\"add-icon\">+</text>\n      </view>\n    </view>\n\n    <!-- Á≠õÈÄâÊ†è -->\n    <view class=\"filter-bar\">\n      <view\n        class=\"filter-item\"\n        :class=\"{ active: currentFilter === 'all' }\"\n        @click=\"setFilter('all')\"\n      >\n        <text>ÂÖ®ÈÉ®</text>\n      </view>\n      <view\n        class=\"filter-item\"\n        :class=\"{ active: currentFilter === 'pending' }\"\n        @click=\"setFilter('pending')\"\n      >\n        <text>ÂæÖÂÆåÊàê</text>\n      </view>\n      <view\n        class=\"filter-item\"\n        :class=\"{ active: currentFilter === 'completed' }\"\n        @click=\"setFilter('completed')\"\n      >\n        <text>Â∑≤ÂÆåÊàê</text>\n      </view>\n    </view>\n\n    <!-- ‰ªªÂä°ÂàóË°® -->\n    <view class=\"task-list\">\n      <view v-if=\"loading\" class=\"loading\">\n        <text>Âä†ËΩΩ‰∏≠...</text>\n      </view>\n\n      <view v-else-if=\"tasks.length === 0\" class=\"empty\">\n        <text class=\"empty-text\">ÊöÇÊó†‰ªªÂä°</text>\n        <text class=\"empty-tip\">ÁÇπÂáªÂè≥‰∏äËßí + Âè∑Ê∑ªÂä†‰ªªÂä°</text>\n      </view>\n\n      <view v-else>\n        <view\n          v-for=\"task in tasks\"\n          :key=\"task._id\"\n          class=\"task-item\"\n          :class=\"{ completed: task.completed }\"\n        >\n          <view class=\"task-content\">\n            <view class=\"task-header\">\n              <text class=\"task-title\">{{ task.title }}</text>\n              <view class=\"task-actions\">\n                <view\n                  class=\"action-btn delete-btn\"\n                  @click=\"deleteTask(task._id)\"\n                >\n                  <text class=\"action-icon\">üóëÔ∏è</text>\n                </view>\n              </view>\n            </view>\n\n            <view v-if=\"task.description\" class=\"task-description\">\n              <text>{{ task.description }}</text>\n            </view>\n\n            <view class=\"task-meta\">\n              <text class=\"task-category\">{{ task.category }}</text>\n              <text class=\"task-priority\" :class=\"'priority-' + task.priority\">\n                {{ getPriorityText(task.priority) }}\n              </text>\n              <text class=\"task-time\">{{ formatTime(task.createTime) }}</text>\n            </view>\n          </view>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed } from \"vue\";\nimport { onShow } from \"@dcloudio/uni-app\";\n\n// ÂìçÂ∫îÂºèÊï∞ÊçÆ\nconst loading = ref(false);\nconst currentFilter = ref(\"all\");\nconst tasks = ref([]);\n\n// ËÆ°ÁÆóÂ±ûÊÄß\nconst filteredTasks = computed(() => {\n  if (currentFilter.value === \"all\") {\n    return tasks.value;\n  } else if (currentFilter.value === \"pending\") {\n    return tasks.value.filter((task) => !task.completed);\n  } else if (currentFilter.value === \"completed\") {\n    return tasks.value.filter((task) => task.completed);\n  }\n  return tasks.value;\n});\n\n// ÊñπÊ≥ï\nconst setFilter = (filter) => {\n  currentFilter.value = filter;\n};\n\nconst getPriorityText = (priority) => {\n  const texts = [\"\", \"‰Ωé\", \"‰∏≠\", \"È´ò\"];\n  return texts[priority] || \"‰∏≠\";\n};\n\nconst formatTime = (time) => {\n  const date = new Date(time);\n  const now = new Date();\n  const diff = now - date;\n\n  if (diff < 60000) {\n    // 1ÂàÜÈíüÂÜÖ\n    return \"ÂàöÂàö\";\n  } else if (diff < 3600000) {\n    // 1Â∞èÊó∂ÂÜÖ\n    return Math.floor(diff / 60000) + \"ÂàÜÈíüÂâç\";\n  } else if (diff < 86400000) {\n    // 1Â§©ÂÜÖ\n    return Math.floor(diff / 3600000) + \"Â∞èÊó∂Ââç\";\n  } else {\n    return date.toLocaleDateString();\n  }\n};\n\n// Ëé∑Âèñ‰ªªÂä°ÂàóË°®\nconst getTaskList = async () => {\n  loading.value = true;\n  try {\n    const result = await uniCloud.callFunction({\n      name: \"task-list\",\n      data: {\n        page: 1,\n        pageSize: 50,\n      },\n    });\n\n    if (result.result.code === 0) {\n      tasks.value = result.result.data.list;\n    } else {\n      uni.showToast({\n        title: result.result.message || \"Ëé∑Âèñ‰ªªÂä°ÂàóË°®Â§±Ë¥•\",\n        icon: \"none\",\n      });\n    }\n  } catch (error) {\n    console.error(\"Ëé∑Âèñ‰ªªÂä°ÂàóË°®Â§±Ë¥•:\", error);\n    uni.showToast({\n      title: \"ÁΩëÁªúÈîôËØØ\",\n      icon: \"none\",\n    });\n  } finally {\n    loading.value = false;\n  }\n};\n\n// Âà†Èô§‰ªªÂä°\nconst deleteTask = async (taskId) => {\n  uni.showModal({\n    title: \"Á°ÆËÆ§Âà†Èô§\",\n    content: \"Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™‰ªªÂä°ÂêóÔºü\",\n    success: async (res) => {\n      if (res.confirm) {\n        try {\n          const result = await uniCloud.callFunction({\n            name: \"task-delete\",\n            data: { taskId },\n          });\n\n          if (result.result.code === 0) {\n            uni.showToast({\n              title: \"Âà†Èô§ÊàêÂäü\",\n              icon: \"success\",\n            });\n            getTaskList(); // ÈáçÊñ∞Ëé∑Âèñ‰ªªÂä°ÂàóË°®\n          } else {\n            uni.showToast({\n              title: result.result.message || \"Âà†Èô§Â§±Ë¥•\",\n              icon: \"none\",\n            });\n          }\n        } catch (error) {\n          console.error(\"Âà†Èô§‰ªªÂä°Â§±Ë¥•:\", error);\n          uni.showToast({\n            title: \"ÁΩëÁªúÈîôËØØ\",\n            icon: \"none\",\n          });\n        }\n      }\n    },\n  });\n};\n\n// Ë∑≥ËΩ¨Âà∞Ê∑ªÂä†È°µÈù¢\nconst goToAddPage = () => {\n  uni.navigateTo({\n    url: \"/pages/add/add\",\n  });\n};\n\n// ÁîüÂëΩÂë®Êúü\nonMounted(() => {\n  getTaskList();\n});\n\n// È°µÈù¢ÊòæÁ§∫Êó∂Âà∑Êñ∞\nonShow(() => {\n  getTaskList();\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  min-height: 100vh;\n  background: #f5f5f5;\n  padding: 20rpx;\n}\n\n.header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 30rpx;\n\n  .title {\n    font-size: 36rpx;\n    font-weight: bold;\n    color: #333;\n  }\n\n  .add-btn {\n    width: 80rpx;\n    height: 80rpx;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    .add-icon {\n      color: white;\n      font-size: 40rpx;\n      font-weight: bold;\n    }\n  }\n}\n\n.filter-bar {\n  display: flex;\n  background: white;\n  border-radius: 20rpx;\n  padding: 10rpx;\n  margin-bottom: 30rpx;\n\n  .filter-item {\n    flex: 1;\n    text-align: center;\n    padding: 20rpx;\n    border-radius: 15rpx;\n    transition: all 0.3s;\n\n    &.active {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: white;\n    }\n\n    text {\n      font-size: 28rpx;\n    }\n  }\n}\n\n.task-list {\n  .loading,\n  .empty {\n    text-align: center;\n    padding: 100rpx 0;\n\n    .empty-text {\n      font-size: 32rpx;\n      color: #999;\n      display: block;\n      margin-bottom: 20rpx;\n    }\n\n    .empty-tip {\n      font-size: 24rpx;\n      color: #ccc;\n    }\n  }\n}\n\n.task-item {\n  background: white;\n  border-radius: 20rpx;\n  padding: 30rpx;\n  margin-bottom: 20rpx;\n  box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.05);\n\n  &.completed {\n    opacity: 0.6;\n\n    .task-title {\n      text-decoration: line-through;\n    }\n  }\n\n  .task-content {\n    .task-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: flex-start;\n      margin-bottom: 20rpx;\n\n      .task-title {\n        font-size: 32rpx;\n        font-weight: bold;\n        color: #333;\n        flex: 1;\n        margin-right: 20rpx;\n      }\n\n      .task-actions {\n        .action-btn {\n          padding: 10rpx;\n\n          .action-icon {\n            font-size: 32rpx;\n          }\n        }\n      }\n    }\n\n    .task-description {\n      margin-bottom: 20rpx;\n\n      text {\n        font-size: 28rpx;\n        color: #666;\n        line-height: 1.5;\n      }\n    }\n\n    .task-meta {\n      display: flex;\n      align-items: center;\n      gap: 20rpx;\n\n      text {\n        font-size: 24rpx;\n        color: #999;\n      }\n\n      .task-category {\n        background: #f0f0f0;\n        padding: 8rpx 16rpx;\n        border-radius: 20rpx;\n      }\n\n      .task-priority {\n        padding: 8rpx 16rpx;\n        border-radius: 20rpx;\n\n        &.priority-1 {\n          background: #e8f5e8;\n          color: #52c41a;\n        }\n\n        &.priority-2 {\n          background: #fff7e6;\n          color: #fa8c16;\n        }\n\n        &.priority-3 {\n          background: #fff1f0;\n          color: #ff4d4f;\n        }\n      }\n    }\n  }\n}\n</style>\n","import MiniProgramPage from 'D:/programming/cuiji-todo-app/cuiji-todo-app/pages/tasks/tasks.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","uniCloud","uni","onMounted","onShow"],"mappings":"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"}